
### DESPOSITS
###########################################################################################################

xhk_voidframe_add_resort_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_resort

	prerequisites = {
		tech_resort_colonies
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_resort }
		owner = { has_technology = "tech_resort_colonies" }
	}

	allow = {
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_resort_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_resort
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_spa_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_spa

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_spa }
		owner = { has_toxic_baths = yes }
	}

	allow = {
		num_sapient_pops >= 100
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_spa_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_spa
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_thrall_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_thrall

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_thrall }
		owner = { has_technology = "tech_slave_colonies" }
	}

	allow = {
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_thrall_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_thrall
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

### PD STUFF
###########################################################################################################

### schlorp THE EXOTIC RESOURCE
xhk_voidframe_schlorp_eludium = {
	owned_planets_only = yes
	icon = decision_harvest_matter_for_planetary_printing
	enactment_time = 100
	ai_weight = { weight = 0 }

	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_eludium }
	}	

	allow = {
		owner = {
			any_planet_within_border = {
				has_planet_flag = pd_floating_planet
				has_planet_flag = giga_frameworld_outpost
			}
		}
	}

	resources = {
		category = resources
		cost = {
			alloys = 5000
			energy = 15000
		}
	}

	show_tech_unlock_if = {
		giga_has_frameworld_origin = yes
	}

	prerequisites = { giga_tech_terraform_shattered }

	effect = {
		add_deposit = xhk_voidframe_eludium
		planet_owner = {
			## give the first tech
			if = {
				limit = {
					nor = { 
						has_technology = tech_eludium_research
						has_tech_option = tech_eludium_research
					}
				}
				add_research_option = tech_eludium_research
				#give_technology = { tech = tech_eludium_research }
			}	
		}	
	}
}

### copy of PD unique
decision_pd_add_floating_island_frameworld_xhk = {
	icon = decision_pd_add_floating_island
	owned_planets_only = yes

	enactment_time = 720
	resources = {
		category = decisions
		cost = {
			sr_eludium = 2500
			influence = 50
		}
	}

	allow = {
		owner = {
			has_technology = tech_eludium_floating_islands
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = d_pd_artifical_floating_islands }
		# allowed frameworld to access the decision
	}

	potential = {
		owner = {
			has_technology = tech_eludium_floating_islands
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = d_pd_artifical_floating_islands }
	}

	effect = {
		add_deposit = d_pd_artifical_floating_islands
		# removed the floating islands visual effect
	}

	ai_weight = {
        weight = 10
  	}
}

### STRUCTURES
###########################################################################################################

xhk_voidframe_add_hyperstructural = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		giga_tech_hyperstructural_ass
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 5000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 10000
			influence = 300
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
			has_gigastructural_constructs = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_hyperstructural }
		NOT = { has_global_flag = hyperstructural_ass_disabled }
		OR = {
			check_variable = { which = giga_hyperstructural_ass_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_hyperstructural_ass value < giga_hyperstructural_ass_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_hyperstructural_ass_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_hyperstructural_ass value < giga_hyperstructural_ass_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_hyperstructural_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_hyperstructural

			from = {
				change_variable = { which = giga_current_hyperstructural_ass value = 1 }
				solar_system = {
					spawn_megastructure = {
						type = hyperstructural_ass_2
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}

				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_sentry= {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_sentry_array
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_sentry }
		NOT = { has_global_flag = vanilla_array_disabled }
		OR = {
			check_variable = { which = giga_vanilla_array_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_vanilla_array value < giga_vanilla_array_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_array_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_array value < giga_vanilla_array_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_sentry_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_sentry
			
			set_star_flag = spy_orb_built
			from = {
				set_timed_country_flag = { flag = has_recently_built_spy_orb years = 20 }
				set_country_flag = built_spyorb
				change_variable = { which = giga_current_vanilla_array value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = spy_orb_0
						planet = this.star
						orbit_distance = 65 
						orbit_angle = 210
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_interstellar_assem = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_interstellar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_interstellar_assem }
		NOT = { has_global_flag = vanilla_interstellar_disabled }
		OR = {
			check_variable = { which = giga_vanilla_interstellar_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_vanilla_interstellar value < giga_vanilla_interstellar_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_interstellar_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_interstellar value < giga_vanilla_interstellar_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_interstellar_assem_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_interstellar_assem

			from = {
				set_timed_country_flag = { flag = has_recently_built_interstellar_assembly years = 20 }
				set_country_flag = built_interstellar_assembly_site
				change_variable = { which = giga_current_vanilla_interstellar value = 1 }
			}
			
			from = {
				solar_system = {
					spawn_megastructure = {
						type = interstellar_assembly_0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_catapult = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_quantum_catapult
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 300
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_catapult }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_no_existing_quantum_catapult"
			from = { NOT = { has_country_flag = built_quantum_catapult_site } }
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_catapult_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_catapult

			from = {
				set_country_flag = built_quantum_catapult_site
				country_event = { id = tutorial.2126 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = quantum_catapult_0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_think_tank = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_science_nexus
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_think_tank }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_nexus_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_nexus value < giga_vanilla_nexus_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_think_tank_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_think_tank

			from = {
				set_timed_country_flag = { flag = has_recently_built_think_tank years = 20 }
				set_country_flag = built_think_tank
				change_variable = { which = giga_current_vanilla_nexus value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = think_tank_0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_strat_coord = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_strategic_coordination
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_strat_coord }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_strategic_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_strategic value < giga_vanilla_strategic_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_strat_coord_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_strat_coord

			from = {
				set_timed_country_flag = { flag = has_recently_built_strategic_coordination_center years = 20 }
				set_country_flag = built_strategic_coordination_center_site
				change_variable = { which = giga_current_vanilla_strategic value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = strategic_coordination_center_0
						orbit_distance = 30 
						orbit_angle = 110
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_art_install = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		tech_mega_art
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_art_install }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_art_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_art value < giga_vanilla_art_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_art_install_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_art_install

			from = {
				set_timed_country_flag = { flag = has_recently_built_mega_art_installation years = 20 }
				set_country_flag = built_mega_art_installation_site
				change_variable = { which = giga_current_vanilla_art value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = mega_art_installation_0
						orbit_distance = 30 
						orbit_angle = 270
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_big_vat = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		giga_tech_the_vat
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_big_vat }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_the_vat_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_the_vat value < giga_the_vat_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_big_vat_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_big_vat

			from = {
				set_timed_country_flag = { flag = has_recently_built_the_vat years = 20 }
				country_event = { id = giga_dialog.11301 }	# Notification
				change_variable = { which = giga_current_the_vat value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = the_vat_0
						orbit_distance = 50 
						orbit_angle = 145
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#moon print
xhk_voidframe_add_moonprint_one = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_printer

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_one }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_one_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_one

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 105
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_moonprint_two = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_printer

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_two }
		has_planet_flag = xhk_voidframe_moonprint_one
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_two_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_two

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 225
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_moonprint_three = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_printer

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_three }
		has_planet_flag = xhk_voidframe_moonprint_two
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_three_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_three

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 345
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}				
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#planet print
xhk_voidframe_add_planetprint = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_printer

	prerequisites = {
		giga_tech_planet_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warplanet_disabled }
		NOT = { has_planet_flag = xhk_voidframe_planetprint }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_planetprint_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_planetprint

			from = {
				country_event = { id = giga_printer.2010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = planetcraft_printer_0_real
						orbit_distance = 80 
						orbit_angle = 165
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}