
### DESPOSITS
###########################################################################################################

xhk_voidframe_add_resort_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_resort

	prerequisites = {
		tech_resort_colonies
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_resort }
		owner = { has_technology = "tech_resort_colonies" }
	}

	allow = {
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_resort_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_resort
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_spa_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_spa

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_spa }
		owner = { has_toxic_baths = yes }
	}

	allow = {
		num_sapient_pops >= 100
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_spa_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_spa
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_thrall_deposit = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_thrall

	enactment_time = 30
	
	resources = {
		category = megastructures
		cost = {
			minerals = 500
			energy = 200
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_thrall }
		owner = { has_technology = "tech_slave_colonies" }
	}

	allow = {
		free_district_slots > 0
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_thrall_deposit_effect
		hidden_effect = {
			add_deposit = xhk_voidframe_thrall
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

### PD STUFF
###########################################################################################################

### schlorp THE EXOTIC RESOURCE
xhk_voidframe_schlorp_eludium = {
	owned_planets_only = yes
	icon = decision_harvest_matter_for_planetary_printing
	enactment_time = 100
	ai_weight = { weight = 0 }

	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = xhk_voidframe_eludium }
		has_global_flag = planetarydiversityuniques
	}	

	allow = {
		custom_tooltip = {
			fail_text = "xhk_voidframe_eludium_continent_failtext"
			from = {
				any_planet_within_border = {
					has_planet_flag = pd_floating_planet
					has_planet_flag = giga_frameworld_outpost
				}
			}
		}
	}

	resources = {
		category = resources
		cost = {
			alloys = 5000
			energy = 15000
		}
	}

	show_tech_unlock_if = {
		giga_has_frameworld_origin = yes
	}

	prerequisites = { giga_tech_terraform_shattered }

	effect = {
		add_deposit = xhk_voidframe_eludium
		planet_owner = {
			## give the first tech
			if = {
				limit = {
					nor = { 
						has_technology = tech_eludium_research
						has_tech_option = tech_eludium_research
					}
				}
				add_research_option = tech_eludium_research
				#give_technology = { tech = tech_eludium_research }
			}	
		}	
	}
}

### copy of PD unique
decision_pd_add_floating_island_frameworld_xhk = {
	icon = decision_pd_add_floating_island
	owned_planets_only = yes

	enactment_time = 720
	resources = {
		category = decisions
		cost = {
			sr_eludium = 2500
			influence = 50
		}
	}

	allow = {
		owner = {
			has_technology = tech_eludium_floating_islands
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = d_pd_artifical_floating_islands }
		# allowed frameworld to access the decision
		has_global_flag = planetarydiversityuniques
	}

	potential = {
		owner = {
			has_technology = tech_eludium_floating_islands
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_deposit = d_pd_artifical_floating_islands }
	}

	effect = {
		add_deposit = d_pd_artifical_floating_islands
		# removed the floating islands visual effect
	}

	ai_weight = {
        weight = 10
  	}
}


### ENCLAVES
###########################################################################################################

xhk_voidframe_add_enclave_curator = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_enclave

	enactment_time = 200

	resources = {
		category = megastructures
		cost = {
			alloys = 500
			influence = 100
			unity = 1000
		}
	}

	potential = {
		NOT = { has_planet_flag = xhk_voidframe_enclave_curator }
		exists = event_target:curator_enclave_country
		event_target:curator_enclave_country = {
			trust = {
				who = from
				value >= 50
			}
		}
	}

	allow = {
		event_target:curator_enclave_country = {
			trust = {
				who = from
				value >= 90
			}
		}
		planet_size >= 75
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_enclave_curator_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_enclave_curator

			star = {
				event_target:curator_enclave_country = {
					create_fleet = {
						name = "NAME_Curator_Alpha_Enclave"
						settings = { spawn_debris = no }
						effect = {
							set_owner = prev
							create_ship = {
								name = random
								design = "NAME_Curator_Enclave_Station"
								graphical_culture = prev
							}							
							set_location = {
								target = prevprev
								angle = 100
								distance = 50
							}
						}
					}
				}
				this.solar_system = {
					set_star_flag = curator_enclave_system
					set_star_flag = enclave
				}
			}
		}
	}
	
	ai_weight = {
		weight = 0
	}
}

xhk_voidframe_add_enclave_artisan = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_enclave

	enactment_time = 200

	resources = {
		category = megastructures
		cost = {
			alloys = 500
			influence = 100
			unity = 1000
		}
	}

	potential = {
		NOT = { has_planet_flag = xhk_voidframe_enclave_artisan }
		exists = event_target:artist_enclave_country
		event_target:artist_enclave_country = {
			trust = {
				who = from
				value >= 50
			}
		}
	}

	allow = {
		event_target:artist_enclave_country = {
			trust = {
				who = from
				value >= 90
			}
		}
		planet_size >= 75
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_enclave_artisan_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_enclave_artisan

			star = {
				event_target:artist_enclave_country = {
					create_fleet = {
						name = "NAME_Ars_Artem"
						settings = { spawn_debris = no }
						effect = {
							set_owner = prev
							create_ship = {
								name = random
								design = "NAME_Artist_Enclave_Station"
								graphical_culture = prev
							}							
							set_location = {
								target = prevprev
								angle = 80
								distance = 50
							}
						}
					}
				}
				this.solar_system = {
					set_star_flag = artist_enclave_station
					set_star_flag = enclave
				}
			}
		}
	}
	
	ai_weight = {
		weight = 0
	}
}

### STRUCTURES
###########################################################################################################

xhk_voidframe_add_hyperstructural = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_hyperstructural

	prerequisites = {
		giga_tech_hyperstructural_ass
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 5000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 10000
			influence = 300
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
			has_gigastructural_constructs = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_hyperstructural }
		NOT = { has_global_flag = hyperstructural_ass_disabled }
		OR = {
			check_variable = { which = giga_hyperstructural_ass_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_hyperstructural_ass value < giga_hyperstructural_ass_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_hyperstructural_ass_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_hyperstructural_ass value < giga_hyperstructural_ass_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_hyperstructural_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_hyperstructural

			from = {
				change_variable = { which = giga_current_hyperstructural_ass value = 1 }
				solar_system = {
					spawn_megastructure = {
						type = hyperstructural_ass_2
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}

				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_sentry= {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_sentry

	prerequisites = {
		tech_sentry_array
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_sentry }
		NOT = { has_global_flag = vanilla_array_disabled }
		OR = {
			check_variable = { which = giga_vanilla_array_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_vanilla_array value < giga_vanilla_array_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_array_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_array value < giga_vanilla_array_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_sentry_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_sentry
			
			set_star_flag = spy_orb_built
			from = {
				set_timed_country_flag = { flag = has_recently_built_spy_orb years = 20 }
				set_country_flag = built_spyorb
				change_variable = { which = giga_current_vanilla_array value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = spy_orb_0
						planet = this.star
						orbit_distance = 65 
						orbit_angle = 210
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_interstellar_assem = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_interstellar_assem

	prerequisites = {
		tech_interstellar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_interstellar_assem }
		NOT = { has_global_flag = vanilla_interstellar_disabled }
		OR = {
			check_variable = { which = giga_vanilla_interstellar_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_vanilla_interstellar value < giga_vanilla_interstellar_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_interstellar_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_interstellar value < giga_vanilla_interstellar_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_interstellar_assem_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_interstellar_assem

			from = {
				set_timed_country_flag = { flag = has_recently_built_interstellar_assembly years = 20 }
				set_country_flag = built_interstellar_assembly_site
				change_variable = { which = giga_current_vanilla_interstellar value = 1 }
			}
			
			from = {
				solar_system = {
					spawn_megastructure = {
						type = interstellar_assembly_0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_catapult = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_catapult

	prerequisites = {
		tech_quantum_catapult
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 300
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_catapult }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_no_existing_quantum_catapult"
			from = { NOT = { has_country_flag = built_quantum_catapult_site } }
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_catapult_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_catapult

			from = {
				set_country_flag = built_quantum_catapult_site
				country_event = { id = tutorial.2126 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = quantum_catapult_0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_think_tank = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_think_tank

	prerequisites = {
		tech_science_nexus
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_big_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_think_tank }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_nexus_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_nexus value < giga_vanilla_nexus_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_think_tank_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_think_tank

			from = {
				set_timed_country_flag = { flag = has_recently_built_think_tank years = 20 }
				set_country_flag = built_think_tank
				change_variable = { which = giga_current_vanilla_nexus value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = think_tank_0
						planet = this.star
						orbit_distance = 50 
						orbit_angle = 260
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_strat_coord = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_strat_coord

	prerequisites = {
		tech_strategic_coordination
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_strat_coord }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_strategic_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_strategic value < giga_vanilla_strategic_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_strat_coord_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_strat_coord

			from = {
				set_timed_country_flag = { flag = has_recently_built_strategic_coordination_center years = 20 }
				set_country_flag = built_strategic_coordination_center_site
				change_variable = { which = giga_current_vanilla_strategic value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = strategic_coordination_center_0
						orbit_distance = 30 
						orbit_angle = 110
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_art_install = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_art_install

	prerequisites = {
		tech_mega_art
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_art_install }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_vanilla_art_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_vanilla_art value < giga_vanilla_art_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_art_install_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_art_install

			from = {
				set_timed_country_flag = { flag = has_recently_built_mega_art_installation years = 20 }
				set_country_flag = built_mega_art_installation_site
				change_variable = { which = giga_current_vanilla_art value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = mega_art_installation_0
						orbit_distance = 30 
						orbit_angle = 270
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

xhk_voidframe_add_big_vat = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_big_vat

	prerequisites = {
		giga_tech_the_vat
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 3000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			unity = @giga_mega_start_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_big_vat }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
		custom_tooltip = {
			fail_text = "requires_not_capped"
			from = {
				OR = {
					check_variable = { which = giga_the_vat_cap value = 0 }						# No Cap
					check_variable = { which = giga_current_the_vat value < giga_the_vat_cap }
				}
			}
		}
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_big_vat_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_big_vat

			from = {
				set_timed_country_flag = { flag = has_recently_built_the_vat years = 20 }
				country_event = { id = giga_dialog.11301 }	# Notification
				change_variable = { which = giga_current_the_vat value = 1 }
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = the_vat_0
						orbit_distance = 50 
						orbit_angle = 145
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#moon print 
#angle 75 (90-15)
xhk_voidframe_add_moonprint_one = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_moonprint

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 1000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_one }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_one_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_one

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 75
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#angle 255 (270-15)
xhk_voidframe_add_moonprint_two = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_moonprint

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 1000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_two }
		has_planet_flag = xhk_voidframe_moonprint_one
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_two_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_two

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 255
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#angle 105 (90+15)
xhk_voidframe_add_moonprint_three = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_moonprint

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 1000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_three }
		has_planet_flag = xhk_voidframe_moonprint_two
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_three_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_three

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 105
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}				
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#angle 285 (270+15)
xhk_voidframe_add_moonprint_four = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_moonprint

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		always = no
	}

	enactment_time = 1000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_four }
		has_planet_flag = xhk_voidframe_moonprint_three
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_four_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_four

			from = {
				country_event = { id = giga_printer.1010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 285
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}				
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#angle 270+-30, 90+-30
xhk_voidframe_add_moonprint_four_more = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_moonprint

	prerequisites = {
		giga_tech_lunar_assembly
	}

	show_tech_unlock_if = {
		always = no
	}

	enactment_time = 4000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 25000
			influence = 300
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warmoon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_moonprint_four_more }
		has_planet_flag = xhk_voidframe_moonprint_four
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_moonprint_four_more_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_moonprint_four_more

			from = {
				solar_system = {
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 300
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 240
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 120
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
					spawn_megastructure = {
						type = lunar_macroreplicator_0_real
						orbit_distance = 70 
						orbit_angle = 60
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}				
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#planet print 
#angle 90
xhk_voidframe_add_planetprint = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_planetprint

	prerequisites = {
		giga_tech_planet_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warplanet_disabled }
		NOT = { has_planet_flag = xhk_voidframe_planetprint }
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_planetprint_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_planetprint

			from = {
				country_event = { id = giga_printer.2010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = planetcraft_printer_0_real
						orbit_distance = 80 
						orbit_angle = 90
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#angle 270
xhk_voidframe_add_planetprint_two = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_planetprint

	prerequisites = {
		giga_tech_planet_assembly
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = warplanet_disabled }
		NOT = { has_planet_flag = xhk_voidframe_planetprint_two }
		has_planet_flag = xhk_voidframe_planetprint
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_planetprint_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_planetprint_two

			from = {
				country_event = { id = giga_printer.2010 }	# Notification
			}

			from = {
				solar_system = {
					spawn_megastructure = {
						type = planetcraft_printer_0_real
						orbit_distance = 80 
						orbit_angle = 270
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#systemprinter
xhk_voidframe_add_systemprint = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_systemprint

	prerequisites = {
		tech_stellar_assembler
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 5000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 700000
			unity = @giga_tera_unity_cost
			rare_crystals = 8000
			volatile_motes = 8000
			exotic_gases = 8000
			#very expensive because we skip to level 3 to avoid the planet destroying effect on T2
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_systemprint }
		stellar_manip_is_active = yes
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_systemprint_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_systemprint

			from = {
				solar_system = {
					spawn_megastructure = {
						type = systemcraft_assembler_3
						orbit_distance = 0 
						orbit_angle = 0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#aetheromirror
xhk_voidframe_add_dsst0 = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_dsst0

	prerequisites = {
		tech_sm_summon_gateway
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 750000
			sr_dark_matter = 50000
			acot_sr_dark_energy = 50000
			influence = 500
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_dsst }
		custom_tooltip = {
			fail_text = "requires_no_existing_dsst"
			from = { NOT = { has_country_flag = built_dsst } }
		}
		has_sots = yes
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_ddst_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_dsst
			from = {
				solar_system = {
					save_event_target_as = dsst_system	#system
					set_star_flag = sm_dsst_explosion_source #system
					spawn_megastructure = {
						type = deep_shroud_summoning_threshold_0_xhk_dupl
						orbit_distance = 0 
						orbit_angle = 0
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
				set_country_flag = built_dsst	#country
			}
			save_event_target_as = sm_dsst #should be megastructure, but targets planet
		}
	}
	
	ai_weight = {
		weight = 0
	}
}

#lathe
#45 deg, 60 dis
xhk_voidframe_add_cosmolathe = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_cosmolathe

	prerequisites = {
		tech_cosmogenesis_world
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 15000
			influence = 300
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_planet_flag = xhk_voidframe_cosmolathe }
		custom_tooltip = {
			fail_text = "requires_no_existing_cosmogenesis_world"
			from = {
				NOT = { has_country_flag = cosmogenesis_world_built }
			}
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}

	effect = {
		custom_tooltip = xhk_voidframe_add_cosmolathe_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_cosmolathe
			from = { set_country_flag = cosmogenesis_world_built }
			from = {
				solar_system = {
					spawn_planet = {
						class = "pc_cosmogenesis_world"
						location = this.star
						orbit_location = yes
						orbit_angle_offset = 45
						orbit_distance_offset = 60
						plane_offset = 5
						size = 2
						has_ring = no
					
						init_effect = {
							set_name = {
								key = pc_cosmogenesis_world
							}
							set_planet_entity = {
								entity = "neural_calculator_phase_1_entity"
							}
							set_surveyed = {
								surveyed = yes
								surveyor = FROM
							}
							set_all_comms_surveyed = yes
							clear_blockers = yes
					
							set_planet_flag = megastructure
							set_planet_flag = cosmogenesis_world_resettle@from
					
							fromfrom.planet = {
								set_planet_flag = has_megastructure
								set_planet_flag = has_cosmogenesis_world
								if = {
									limit = { has_orbital_station = yes }
									orbital_station = {
										dismantle = yes
									}
								}
							}
					
							set_owner = fromfrom
							set_controller = fromfrom
							create_pop = {
								species = owner_main_species
							}
							from = {
								room_name_override = ""
							}
						}
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#psibeacon
#135 deg, 60 dis
xhk_voidframe_add_psibeacon = {
	owned_planets_only = yes
	icon = decision_xhk_voidframe_add_psibeacon

	prerequisites = {
		giga_tech_psychic_beacon
	}

	show_tech_unlock_if = {
		owner = { giga_has_frameworld_origin = yes }
	}

	enactment_time = 2000
	
	resources = {
		category = megastructures
		cost = {
			alloys = 5000
			influence = 100
			unity = @giga_giga_unity_cost
		}
	}
	
	potential = {
		exists = owner
		owner = {
			giga_has_frameworld_origin = yes
		}
		is_planet_class = pc_giga_frameworld
		NOT = { has_global_flag = psychic_beacon_disabled }
		NOT = { has_planet_flag = xhk_voidframe_psibeacon }
		OR = {
			check_variable = { which = giga_psychic_beacon_cap value = 0 }						# No Cap
			check_variable = { which = giga_current_psychic_beacon value < giga_psychic_beacon_cap }
		}
	}
	
	allow = {		
		has_major_upgraded_capital = yes
	}
	
	effect = {
		custom_tooltip = xhk_voidframe_add_psibeacon_effect

		hidden_effect = {
			set_planet_flag = xhk_voidframe_psibeacon

			from = {
				change_variable = { which = giga_current_psychic_beacon value = 1 }
				solar_system = {
					spawn_megastructure = {
						type = psychic_beacon_1
						orbit_distance = 60 
						orbit_angle = 135
						planet = this.star
						owner = space_owner
						graphical_culture = owner
					}
				}
			}
		}
	}
	
	ai_weight = {
		weight = 10
	}
}

#225 deg, 60 dis
#beyond the shroud labyrinth
# xhk_voidframe_add_labyrinthabs = {
# 	owned_planets_only = yes
# 	icon = decision_xhk_voidframe_add_labyrinthabs

# 	enactment_time = 2000
	
# 	resources = {
# 		category = megastructures
# 		cost = {
# 			alloys = 5000
# 			influence = 50
# 		}
# 	}
	
# 	potential = {
# 		exists = owner
# 		owner = {
# 			giga_has_frameworld_origin = yes
# 			has_country_flag = bts_labyrinth_of_abstraction_unlocked
# 		}
# 		is_planet_class = pc_giga_frameworld
# 		NOT = { has_planet_flag = xhk_voidframe_labyrinthabs }
#         NOT = {
#             any_planet_within_border = {
#                 is_planet_class = pc_bts_labyrinth_of_abstraction
#             }
#         }
# 	}
	
# 	allow = {		
# 		has_major_upgraded_capital = yes
# 	}

# 	effect = {
# 		custom_tooltip = xhk_voidframe_add_labyrinthabs_effect

# 		hidden_effect = {
# 			set_planet_flag = xhk_voidframe_labyrinthabs
# 			from = {
# 				solar_system = {
# 					spawn_planet = {
# 						class = "pc_bts_labyrinth_of_abstraction"
# 						location = this.star
# 						orbit_location = yes
# 						orbit_angle_offset = 225
# 						orbit_distance_offset = 60
# 						plane_offset = 5
# 						has_ring = no
					
# 						init_effect = {
# 							set_name = {
# 								key = pc_bts_labyrinth_of_abstraction
# 							}
# 							set_surveyed = {
# 								surveyed = yes
# 								surveyor = FROM
# 							}
# 							set_all_comms_surveyed = yes
# 							clear_blockers = yes
# 							clear_deposits = yes
# 							prevent_anomaly = yes
				
# 							set_planet_flag = megastructure
				
# 							set_owner = fromfrom
# 							set_controller = fromfrom
# 							create_pop = {
# 								species = owner_main_species
# 							}
# 							from = {
# 								room_name_override = ""
# 							}
				
# 							remove_all_buildings = yes
# 							add_building = bts_labyrinth_of_abstraction_core_1
							
# 							owner = {
# 								if = {
# 									limit = {
# 										NOT = {
# 											any_situation = { is_situation_type = situation_bts_conceptual_mastery }
# 										}
# 									}
# 									country_event = {
# 										id = bts.20
# 										days = @bts_days_before_conceptual_mastery
# 										scopes = {
# 											from = prev
# 										}
# 									}
# 								}
# 							}
# 						}
# 					}
# 				}
# 			}
# 		}
# 	}
	
# 	ai_weight = {
# 		weight = 0
# 	}
# }


